# バレーボール点示ソフト（Python Tkinter 版）マニュアル

## 📋 操作説明

- `TeamA + / TeamB +`：得点を加算。サーバーでなければローテーション＋サーバー交代。
- `Undo`：1手前の状態に戻す（得点、ローテ、サーバー、セット数、チーム名含む）。
- `セット数`：中央のセット表示をクリックすると変更可能。
- `チーム名`：青／緑のチームラベルをクリックで変更。
- `背番号`：各選手の番号をクリックで編集可能。

---

## 🧠 データ構造

| 変数           | 内容                                                |
|----------------|-----------------------------------------------------|
| `teamA_rot`    | Aチームの背番号（`deque`）※ローテ順そのもの         |
| `teamA_pos`    | Aチームの各選手の配置位置（`(row, col)`のリスト）    |
| `teamB_rot`    | Bチームの背番号（`deque`）                          |
| `teamB_pos`    | Bチームの配置位置                                    |
| `server_team`  | 現在のサーバーを持つチーム `"A"` または `"B"`        |
| `scoreA/B`     | 各チームの得点（整数）                               |
| `set_count`    | セット数                                             |
| `history`      | Undo用の状態保存リスト（辞書のスタック）             |

---

## 🔁 処理の流れ

### `add_point_A` / `add_point_B`

1. 現在の状態を `save_state()` で履歴に保存
2. サーバーが同じなら得点のみ加算
3. サーバーが異なる場合：
   - 得点を加算
   - 対象チームのローテーション（`rotate(-1)`）
   - サーバーの切り替え
4. `update_rotation_display()` で画面更新

### `undo`

- `history` から1つ前の状態を取得し、スコア・ローテ・サーバー・セット数を復元

---

## 🖼 表示マッピング（Grid配置）

### Aチーム（左側）

```
(2,0) 左上   (2,1) 右上
(3,0) 左中   (3,1) 右中
(4,0) 左下★  (4,1) 右下
```

### Bチーム（右側）

```
(2,3) 左上   (2,4) 右上★
(3,3) 左中   (3,4) 右中
(4,3) 左下   (4,4) 右下
```

※ ★ = サーバー位置（index = 0）

---

## 💡 特徴と拡張性

- 論理的ローテ順と表示位置が明確に一致 → 保守しやすい
- `deque.rotate(-1)` による時計回りローテーション
- `display_order` 不要な設計で拡張性が高い
- 今後の拡張例：
  - CSV保存・読込
  - コート図との連携（Canvas）
  - リベロ交代・選手交代管理
  - ネットワーク同期（試合実況表示）

---

## 📎 ライセンス / 利用

このソフトウェアは教育・記録用途での自由利用が可能です。
